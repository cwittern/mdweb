{% extends "laybase.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}


{% block subhead %}

<header class="jumbotron subhead" id="overview">
  <div class="container">
    <p>Advanced search</p>
  </div>
</header>


{% endblock subhead %}



{% block body %}

<div>
  <h2>Advanced search</h2>
  <p style="color:red;">{{help}}</p>
  <form id="advsearchinput" action="{{url_for('main.advsearch')}}" method="POST">
    <table>
      <tr><td>Find: </td><td><input style="width: 200px" type="text" name="key0" value="{{key0}}"/></td></tr>

      <tr><td>
<select name ="conn1" style="width: 100px">
    <option value="and" {% if conn1 == "and" %} selected {% endif %}>AND</option>
    <option value="or" {% if conn1 == "or" %} selected {% endif %}>OR</option>
    <option value="andnot" {% if conn1 == "andnot" %} selected {% endif %}>AND NOT</option>
</select>
	</td><td><input style="width: 200px" type="text" name="key1" value="{{key1}}"/></td></tr>
      <tr><td>
<select name ="conn2" style="width: 100px">
    <option value="and" {% if conn2 == "and" %} selected {% endif %}>AND</option>
    <option value="or" {% if conn2 == "or" %} selected {% endif %}>OR</option>
    <option value="andnot" {% if conn2 == "andnot" %} selected {% endif %}>AND NOT</option>
</select>
	</td><td><input style="width: 200px" type="text" name="key2" value="{{key2}}"/></td></tr>
      <tr><td>Within</td><td><select name ="acc" style="width: 200px">
    <option value="line" {% if acc == "None" %} selected {% endif %}>18 characters</option>
    <option value="para" {% if acc == "para" %} selected {% endif %}>same paragraph</option>
    <option value="juan" {% if acc == "juan" %} selected {% endif %}>same juan 巻</option>
</select>
	</td>
	<td><input style="margin-bottom:5px" type="submit" value="{{_('Search')}}"/>　</td>
      </tr>
    </table>  
      


</p>
  </form>
  {% if res %}
  <hr/>
  <h2>Results: Found {{res|length}} in {{df}}</h2>
  <table id="result">
    <tr>
      <td>Score</td>
      <td>Text</td>
      <td>Location</td>
    </tr>
  {% else %}
  {% endif %}
    {% for r in res %}
      {% set it_txtid, it_juan = r[2].split(':')[0].split('_') %}
      {% set it_page = r[2].split(':')[1] %}
      {% set it_line = r[2].split(':')[2] %}
    <tr>
      <td>{{r[0]}}</td>
      <td>{{r[1]}}</td>
      <td><a href="{{url_for('main.showtext', id=it_txtid, juan=it_juan, query=key, _anchor=it_juan+'-'+it_page)}}" title="{{it_txtid}} ">{{r[2]}}</a></td>
    </tr>
    {% endfor %}
  </table>
</div>


{% endblock %}

{% block sidebar %}
<div>
  <h2>{{_('Actions')}}</h2>
</div>  
{% endblock sidebar %}

